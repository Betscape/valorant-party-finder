"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},7914:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>y,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f});var n={};t.r(n),t.d(n,{POST:()=>c});var o=t(9303),i=t(8716),s=t(3131),a=t(7070),u=t(2021),l=t(1732),p=t(9178);let d=new Map;async function c(e){try{await (0,u.Z)();let{email:r,password:t}=await e.json(),n=e.ip||e.headers.get("x-forwarded-for")||"unknown";if(!function(e,r=5,t=9e5){let n=Date.now(),o=n-t,i=(d.get(e)||[]).filter(e=>e>o);return!(i.length>=r)&&(i.push(n),d.set(e,i),!0)}(`login:${n}`))return a.NextResponse.json({success:!1,error:"Too many login attempts. Please try again later."},{status:429});if(!r||!t)return a.NextResponse.json({success:!1,error:"Email and password are required"},{status:400});let o=await l.Z.findOne({email:r});if(!o||!await (0,p.Gv)(t,o.password))return a.NextResponse.json({success:!1,error:"Invalid credentials"},{status:401});let i=(0,p.RA)({userId:o._id.toString(),email:o.email});return a.NextResponse.json({success:!0,data:{token:i,user:{id:o._id,email:o.email,riotId:o.riotId,verified:o.verified}}})}catch(e){return console.error("Login error:",e),a.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\Users\\jgero\\Desktop\\myprograms\\valo\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:h}=m,v="/api/auth/login/route";function y(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}},9178:(e,r,t)=>{t.d(r,{Gv:()=>l,RA:()=>p,bE:()=>d,c_:()=>u});var n=t(1482),o=t.n(n),i=t(2023),s=t.n(i);let a="your-super-secret-jwt-key-change-this-in-production";async function u(e){return s().hash(e,12)}async function l(e,r){return s().compare(e,r)}function p(e){return o().sign(e,a,{expiresIn:"7d"})}function d(e){let r=function(e){let r=e.headers.get("authorization");return r&&r.startsWith("Bearer ")?r.substring(7):null}(e);if(!r)return null;let t=function(e){try{return o().verify(e,a)}catch(e){return null}}(r);return t?.userId||null}},2021:(e,r,t)=>{t.d(r,{Z:()=>a});var n=t(1185),o=t.n(n);let i="mongodb+srv://jgero961_db_user:5vS64ihmut6ImZ7i@cluster0.n1v0f5m.mongodb.net/valorant-party-finder?retryWrites=true&w=majority&appName=Cluster0";if(!i)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let s=global.mongoose;s||(s=global.mongoose={conn:null,promise:null});let a=async function(){if(s.conn)return s.conn;s.promise||(s.promise=o().connect(i,{bufferCommands:!1}).then(e=>e));try{s.conn=await s.promise}catch(e){throw s.promise=null,e}return s.conn}},1732:(e,r,t)=>{t.d(r,{Z:()=>s});var n=t(1185),o=t.n(n);let i=new n.Schema({email:{type:String,required:!0,unique:!0,lowercase:!0,trim:!0,index:!0},password:{type:String,required:!0,minlength:6},riotId:{type:String,required:!0,trim:!0,index:!0},bio:{type:String,maxlength:500},verified:{type:Boolean,default:!1},blocked:[{type:n.Schema.Types.ObjectId,ref:"User"}]},{timestamps:!0}),s=o().models.User||o().model("User",i)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[948,644],()=>t(7914));module.exports=n})();